version: "3"

services:
  mig-ai:
    build: .
    volumes:
      # mount for development purposes
      - ./:/app
      # custom volumes
      - ~/.cache:/root/.cache
      - ~/.python_history:/root/.python_history
    container_name: mig-ai
    tty: true
    deploy:
      resources:
        reservations:
          devices:
            - capabilities: [gpu]

  wandb:
    image: wandb/local
    container_name: wandb-server
    env_file:
      - .env
    environment:
      - WANDB_MODE=offline
      - WANDB_DIR=./.wandb/
    tty: true
